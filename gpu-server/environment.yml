# Grow GPU Server — conda 環境定義
#
# 使い方:
#   cd gpu-server
#   conda env update -f environment.yml -p ./.venv --prune
#   conda activate ./.venv
#
#   # PaddlePaddle GPU は別途インストール（CUDA バージョンに合わせる）
#   pip install paddlepaddle-gpu==3.3.0 -i https://www.paddlepaddle.org.cn/packages/stable/cu126/
#
# GPU なしの場合:
#   pytorch の cpuonly チャンネルに切り替えてください
#   - pytorch::cpuonly

name: grow-gpu
channels:
  - conda-forge
  - pytorch
  - nvidia

dependencies:
  - python=3.12

  # FastAPI
  - fastapi>=0.115.0
  - uvicorn>=0.30.0

  # Auth
  - python-jose>=3.3.0
  - passlib>=1.7.4
  - python-multipart>=0.0.9
  - httpx>=0.27.0

  # Database
  - sqlalchemy>=2.0.0
  - aiosqlite>=0.20.0

  # PyTorch (CUDA 12.x)
  - pytorch::pytorch>=2.4
  - pytorch::torchvision
  - pytorch::pytorch-cuda=12.4

  # Vision
  - transformers>=4.45.0
  - pillow>=10.0.0

  # Utilities
  - pydantic>=2.0.0
  - pydantic-settings>=2.0.0

  # pip のみ（conda-forge に無いパッケージ）
  - pip
  - pip:
      # AI (Claude Agent SDK — Max 定額プラン対応)
      - claude-agent-sdk>=0.1.0

      # OCR (paddleocr は pip のみ)
      - paddleocr>=2.9.0

      # paddlepaddle-gpu は PaddlePaddle 独自インデックスが必要なため
      # ここには書けません。上のコメントを参照して手動インストールしてください。
      # pip install paddlepaddle-gpu==3.3.0 -i https://www.paddlepaddle.org.cn/packages/stable/cu126/
      # CUDA: cu118 / cu126 / cu129 / cu130
